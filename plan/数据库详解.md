Users表（用户表）设计详解
字段设计：
1. phone VARCHAR(20) NOT NULL UNIQUE（选择手机号作为唯一标识）
  ○ 场景：分销系统需要实名制，手机号便于验证身份
  ○ 实例：用户注册时 INSERT INTO users (phone, password, role) VALUES ('13800138000', 'hash_pwd', 'agent')
2. role ENUM('super_admin', 'director', 'leader', 'sales', 'agent')
  ○ 场景：权限控制，不同角色有不同功能权限
  ○ 实例：
    ■ super_admin：系统管理员，可以管理所有用户
    ■ director：总监，可以管理多个团队
    ■ leader：组长，可以管理销售团队
    ■ sales：销售，负责客户成交
    ■ agent：代理，负责推广获客
3. inviter_id BIGINT DEFAULT NULL（邀请人字段）
  ○ 场景：分销系统核心是推荐关系，用于计算间接佣金
  ○ 实例：用户A(id=100)邀请用户B注册，B的inviter_id=100
  ○ 佣金计算：B产生业绩时，A可以获得间接佣金
4. status ENUM('active', 'inactive')（为什么需要状态管理？）
  ○ 场景：用户生命周期管理，风控需要
  ○ 实例：
    ■ active：正常用户，可以正常使用所有功能
    ■ inactive：暂停用户，违规操作后禁止使用
5. total_gmv DECIMAL(15,2)（存储总GMV）
  ○ 场景：代理等级升级判断，业绩排名统计
  ○ 实例：
    ■ 用户达到10万GMV可升级到SV2
    ■ 月度排行榜按total_gmv排序
🔗 约束设计：
1. FOREIGN KEY (inviter_id) REFERENCES users(id) ON DELETE SET NULL(为什么用ON DELETE SET NULL？)
  ○ 场景：如果邀请人账户被删除，被邀请人不应该被连带删除
  ○ 实例：
    ■ 用户A邀请了用户B、C、D
    ■ 如果A账户被删除，B、C、D的inviter_id暂时设置为NULL
    ■ 保留了用户B、C、D的账户和历史数据
Agent_Levels表（代理等级表）设计详解
字段设计：
1. min_gmv & max_gmv DECIMAL(15,2) DEFAULT NULL
  ○ 场景：等级升级和维持的业绩要求
  ○ 实例：
    ■ SV1：0-49999.99
    ■ SV2：50000-99999.99
    ■ SV6：800000以上（max_gmv为NULL）
2. level_order INT NOT NULL UNIQUE（排序字段）
  ○ 场景：等级显示排序，升级逻辑判断
  ○ 实例：按level_order排序显示等级列表
🔗 约束设计：
1. chk_commission_rate CHECK (commission_rate >= 0 AND commission_rate <= 100)（佣金比例范围约束）
  ○ 场景：防止配置错误，佣金比例不能为负数或超过100%
  ○ 实例：
    ■ 防止误输入-5%或150%这样的无效值
    ■ 数据输入验证的最后一道防线
2. chk_gmv_range CHECK (min_gmv IS NULL OR max_gmv IS NULL OR min_gmv <= max_gmv)（范围逻辑检查）
  ○ 场景：确保GMV区间的逻辑正确性
  ○ 实例：
    ■ 防止配置min_gmv=100000, max_gmv=50000这样的错误
    ■ 允许NULL值用于表示无限制
User_Agent_Level表（用户与代理等级绑定表）设计详解
字段设计：
1. user_id BIGINT NOT NULL (主键)
  ○ 场景：一个用户同时只能有一个等级
  ○ 实例：用户张三(id=100)只能是SV3，不能同时是SV2和SV4
  ○ 业务约束：避免一个用户被分配多个等级的混乱情况
2. level_id INT NOT NULL（不能为空）
    ■ 场景：每个代理用户必须有明确的等级
    ■ 实例：新注册的代理默认分配SV1等级
  ○ 数据类型匹配：与agent_levels表的id字段保持一致
3. assigned_by BIGINT DEFAULT NULL（分配人字段）
  ○ 场景：等级分配的责任追溯，管理审计
  ○ 实例：
    ■ 系统自动分配：assigned_by = NULL
    ■ 管理员手动分配：assigned_by = 管理员ID
    ■ 自动升级：assigned_by = 系统用户ID
  ○ 为什么允许NULL
    ■ 系统自动分配的情况下可以为空
4. assigned_at DATETIME DEFAULT CURRENT_TIMESTAMP（分配时间）
  ○ 场景：等级变更历史追踪，业绩统计周期
  ○ 实例：统计用户在SV2等级停留了多长时间
5. effective_date & expiry_date（等级时效性管理）
  ○ 场景：等级有效期管理
  ○ 实例：
    ■ 试用期代理：3个月临时SV2等级
    ■ 促销活动：临时提升等级1个月
6. current_period_gmv DECIMAL(15,2)（周期GMV）
  ○ 场景：月度业绩考核，等级保持判断
  ○ 实例：
    ■ SV3用户需要月GMV达到2万才能保持等级
    ■ 未达标自动降级到SV2
  ○ 与total_gmv的区别：
    ■ total_gmv：用户历史总业绩
    ■ current_period_gmv：当前考核周期业绩
7. current_period_start & current_period_end（周期时间范围）
  ○ 场景：明确业绩统计周期，支持不同的考核制度
  ○ 实例：
    ■ 月度考核：2024-01-01 到 2024-01-31
    ■ 季度考核：2024-01-01 到 2024-03-31
🔗 约束设计：
1. FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE
  ○ 场景：自动维护数据的整洁，避免产生“孤儿记录”
  ○ 实例：用户账户被删除时，不需要保留其等级分配记录
2. FOREIGN KEY (level_id) REFERENCES agent_levels(id) ON DELETE RESTRICT
  ○ 场景：防止误删除正在使用的等级
  ○ 实例：不能在不删除对应用户的情况下删除其 SV 等级配置
3. FOREIGN KEY (assigned_by) REFERENCES users(id) ON DELETE SET NULL
  ○ 场景：分配人删除后，等级分配记录仍需保留
  ○ 实例：管理员离职后，其分配的等级记录仍然有效
Agent_Level_Audit（代理等级审核表）设计详解
字段设计：
1. before_level INT DEFAULT NULL（允许NULL）
  ○ 场景：首次分配等级时，用户之前没有等级
  ○ 实例：
    ■ 新用户首次分配SV1：before_level = NULL, after_level = 1
    ■ 从SV2升级到SV3：before_level = 2, after_level = 3
2. after_level INT NOT NULL（不能为空）
  ○ 场景：每次审核都必须有明确的目标等级
  ○ 实例：即使是降级或取消等级，也需要明确的目标状态
3. status ENUM('approved','rejected','pending')（审核状态）
  ○ 场景：等级变更需要审批流程，不是所有变更都自动生效
  ○ 实例：
    ■ pending：等待审核（默认状态）
    ■ approved：审核通过，等级变更生效
    ■ rejected：审核拒绝，等级保持原状
4. audit_by BIGINT DEFAULT NULL（审核人字段）
  ○ 场景：责任追溯，审核权限管理
  ○ 实例：
    ■ 系统自动审核：audit_by = NULL
    ■ 管理员手动审核：audit_by = 管理员ID
5. audit_feedback TEXT DEFAULT NULL（审核反馈）
  ○ 场景：审核决策的依据记录，特别是拒绝的原因
  ○ 实例：
    ■ 通过："用户业绩达标，符合升级条件"
    ■ 拒绝："用户GMV未达到SV3要求的10万最低标准"
6. audited_at DATETIME DEFAULT NULL
  ○ 场景：区分申请时间和审核时间，计算审核效率
  ○ 实例：
    ■ created_at：2024-01-01 10:00:00（申请时间）
    ■ audited_at：2024-01-02 14:30:00（审核时间）
    ■ 审核耗时：1天4小时30分钟
🔗 约束设计
1. FOREIGN KEY (user_id) ... ON DELETE CASCADE
  ○ 场景：用户删除时，其审核历史也应该删除
  ○ 实例：用户账户被删除时，不需要保留其等级审核记录
2. FOREIGN KEY (after_level) ... ON DELETE RESTRICT
  ○ 场景：防止删除正在被审核的目标等级
  ○ 实例：如果有用户正在申请升级到SV4，则不能删除SV4等级
3. FOREIGN KEY (audit_by) ... ON DELETE SET NULL
  ○ 场景：审核人离职后，审核记录仍需保留
  ○ 实例：管理员离职后，其审核的记录仍然有效
Customer_Leads表（客户表）设计详解
字段设计
1. phone VARCHAR(20) NOT NULL UNIQUE（客户手机号）
  ○ 场景：手机号作为客户唯一标识，防止重复录入
  ○ 实例：
    ■ 客户张三手机号13800138000只能存在一条线索记录
    ■ 如果多个代理录入同一客户，系统应提示重复
2. wechat VARCHAR(64) DEFAULT NULL（微信号）
  ○ 场景：微信是主要的客户沟通渠道，销售需要添加客户微信进行跟进
  ○ 实例：客户微信号"zhang_san_2024"，销售通过微信建立联系
  ○ 允许NULL：不是所有客户都愿意提供微信号
3. submitted_by BIGINT NOT NULL（提交人ID）
  ○ 场景：记录客户资源的来源，用于业绩归属和佣金计算
  ○ 实例：
    ■ 代理张三(id=100)提交客户资源，submitted_by=100
    ■ 后续成交时，张三可以获得推广佣金
    ■ 不能为空：必须明确资源来源
4. assigned_sales_id BIGINT DEFAULT NULL （分配销售ID）
  ○ 场景：将客户资源分配给具体的销售人员跟进
  ○ 实例：
    ■ 初始状态：assigned_sales_id = NULL（待分配）
    ■ 分配给销售李四：assigned_sales_id = 200
  ○ 允许NULL：新提交的资源可能暂未分配
5. status ENUM('new', 'contacted', 'interested', 'closed', 'invalid') DEFAULT 'new' （状态）
  ○ 场景：客户跟进状态管理，跟踪销售进度
  ○ 实例：
    ■ new：新提交的客户资源
    ■ contacted：已联系客户
    ■ interested：客户有购买意向
    ■ closed：已成交
    ■ invalid：无效客户（空号、拒绝等）
6. follow_up_notes TEXT DEFAULT NULL （跟进备注）
  ○ 场景：销售人员记录客户沟通情况，便于后续跟进
  ○ 实例：
    ■ "客户对产品感兴趣，但价格敏感，需要优惠活动"
    ■ "客户已加微信，约定明天详细介绍产品"
7. created_at DATETIME DEFAULT CURRENT_TIMESTAMP （创建时间）
  ○ 场景：记录客户资源提交时间，用于资源分配和统计
  ○ 实例：分析代理的客户提交活跃度，按时间段统计资源质量
8. updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP （更新时间）
  ○ 场景：跟踪客户资源的最后更新时间，监控跟进活跃度
  ○ 实例：销售经理检查哪些客户长时间未更新，提醒销售跟进
🔗 约束设计
1. FOREIGN KEY (submitted_by) REFERENCES users(id) ON DELETE RESTRICT
  ○ 场景：保护客户资源的来源追溯，防止误删提交人
  ○ 实例：如果代理张三提交了很多客户资源，不能删除张三的账户，否则无法追溯资源来源
2. FOREIGN KEY (assigned_sales_id) REFERENCES users(id) ON DELETE SET NULL
  ○ 场景：销售人员离职后，客户资源需要重新分配
  ○ 实例：
    ■ 销售李四离职，其负责的客户资源的assigned_sales_id设为NULL
    ■ 管理员可以重新分配这些客户给其他销售
Products表（产品表）设计详解
字段设计
1. name VARCHAR(100) NOT NULL（商品名称）
  ○ 场景：商品的唯一可读标识，用于在订单、后台管理和前端页面中展示。
  ○ 实例：
    ■ "XX品牌高端护肤精华液"
    ■ "年度VIP会员服务"
  ○ 不能为空：每个商品必须有名称。
2. description TEXT DEFAULT NULL（商品描述）
  ○ 场景：提供商品的详细信息、规格、使用方法等，通常用于商品详情页。
  ○ 实例：包含图文详情、成分列表、适用人群等内容的富文本。
  ○ 允许NULL：对于一些简单的服务或虚拟商品，可能不需要复杂的描述。
3. price DECIMAL(10,2) NOT NULL（商品价格）
  ○ 场景：定义商品的基础售价，是计算成交金额和佣金的基础。
  ○ 实例：
    ■ 998.00
    ■ 12800.00
  ○ 用DECIMAL保证精度：避免使用FLOAT或DOUBLE导致金额计算出现浮点数误差。
4. status ENUM('active', 'inactive') DEFAULT 'active'（商品状态）
  ○ 场景：管理商品的上架和下架，控制商品是否可被销售。
  ○ 实例：
    ■ active：商品正常在售。
    ■ inactive：商品已下架，不能创建新的成交记录。
Deals表（交易表）设计详解
字段设计
1. customer_id BIGINT NOT NULL（客户ID）
  ○ 场景：关联到具体的客户资源，明确这笔交易是哪个客户完成的。
  ○ 实例：关联到 customer_leads 表中 id 为 1001 的客户。
  ○ 不能为空：每笔交易必须有明确的客户。
2. product_id BIGINT NOT NULL（商品ID）
  ○ 场景：关联到具体的商品，明确这笔交易销售的是哪个商品。
  ○ 实例：关联到 products 表中 id 为 88 的商品。
  ○ 不能为空：每笔交易必须有对应的商品。
3. sales_id BIGINT NOT NULL（销售ID）
  ○ 场景：记录完成这笔交易的销售人员，用于业绩归属和计算销售提成。
  ○ 实例：销售李四 (id=200) 完成了这笔交易，sales_id 为 200。
  ○ 不能为空：必须明确业绩归属。
4. amount DECIMAL(10,2) NOT NULL（成交金额）
  ○ 场景：记录最终的实际成交价，可能因为折扣、优惠券等原因与商品原价不同。
  ○ 实例：
    ■ 商品原价 998.00，使用优惠券后实际成交 898.00。
    ■ 该字段是计算佣金的核心依据。
5. status ENUM('pending', 'completed', 'refunded') DEFAULT 'completed'（状态）
  ○ 场景：管理交易的生命周期，应对付款、退款等不同情况。
  ○ 实例：
    ■ pending：已下单但未付款或等待确认。
    ■ completed：交易完成，可以计算佣金。
    ■ refunded：已退款，需要扣除或取消相关佣金。
6. deal_date DATETIME DEFAULT CURRENT_TIMESTAMP（成交时间）
  ○ 场景：记录交易完成的精确时间，用于按月/季度统计业绩和佣金。
  ○ 实例：2024-07-15 14:30:00，这条记录将计入7月份的业绩。
🔗 约束设计
1. FOREIGN KEY (customer_id) REFERENCES customer_leads(id) ON DELETE RESTRICT
  ○ 场景：保护交易记录的完整性，防止关联的客户信息被意外删除。
  ○ 实例：如果一个客户已经有了成交记录，就不能直接删除这个客户的线索，需要先处理其成交记录。
2. FOREIGN KEY (product_id) REFERENCES products(id) ON DELETE RESTRICT
  ○ 场景：保护交易记录的完整性，防止关联的商品信息被意外删除。
  ○ 实例：如果一个商品已经有成交记录，就不能删除该商品，可以将其状态设为 inactive。
3. FOREIGN KEY (sales_id) REFERENCES users(id) ON DELETE RESTRICT
  ○ 场景：保护交易记录和业绩归属的完整性，防止关联的销售人员被意外删除。
  ○ 实例：如果一个销售人员已经有成交记录，不能直接删除该销售的账户，可以将其状态设为 inactive。
Commissions表（佣金记录表）设计详解
字段设计
1. user_id BIGINT NOT NULL (用户ID)
  ○ 场景：明确佣金的归属人
  ○ 实例：
    ■ 销售李四的佣金：user_id = 200
    ■ 李四的邀请人王五的间接佣金：user_id = 300
  ○ 不能为空：每笔佣金都必须有明确的受益人
2. deal_id BIGINT NOT NULL (成交记录ID)
  ○ 场景：关联佣金的来源，便于追溯和核对
  ○ 实例：佣金记录与成交记录1001关联，可以查询到佣金来自哪个客户、哪个商品
  ○ 不能为空：必须明确佣金由哪笔成交产生
3. level ENUM('direct', 'indirect') NOT NULL (佣金层级)
  ○ 场景：区分不同类型的佣金
  ○ 实例：
    ■ direct: 直接佣金，由成交销售本人获得
    ■ indirect: 间接佣金，由销售的邀请人获得
4. rate DECIMAL(5,2) NOT NULL (佣金比例)
  ○ 场景：记录计算佣金时使用的具体比例
  ○ 实例：
    ■ 直接佣金比例：10.00 (%)
    ■ 间接佣金比例：1.00 (%)
  ○ 不能为空：佣金计算必须有明确的比例依据
5. amount DECIMAL(10,2) NOT NULL (佣金金额)
  ○ 场景：记录计算出的具体佣金数额，是财务结算的直接依据
  ○ 实例：成交金额8999元，直接佣金10%，则amount为 899.90
  ○ 不能为空：最终的佣金金额必须明确
6. status ENUM('pending', 'paid', 'cancelled') DEFAULT 'pending' (状态)
  ○ 场景：佣金的结算状态管理
  ○ 实例：
    ■ pending: 待结算（默认状态）
    ■ paid: 已支付
    ■ cancelled: 已取消（如订单退款）
6. created_at DATETIME DEFAULT CURRENT_TIMESTAMP (创建时间)
  ○ 场景：记录佣金生成的时间，用于财务对账和周期统计
  ○ 实例：统计2024年1月的待结算佣金总额
🔗 约束设计
1. FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE RESTRICT
  ○ 场景：保护财务数据的完整性，防止删除有佣金记录的用户
  ○ 实例：如果用户张三有待结算的佣金，系统应禁止删除其账户，以防资金流失
2. FOREIGN KEY (deal_id) REFERENCES deals(id) ON DELETE RESTRICT
  ○ 场景：保护佣金来源的完整性，防止删除已产生佣金的成交记录
  ○ 实例：如果成交记录1001已产生佣金，不能删除该成交记录，否则佣金来源无法追溯
Promotions表（推广任务表）设计详解
字段设计
1. agent_id BIGINT NOT NULL (代理ID)
  ○ 场景：明确推广任务的执行人
  ○ 实例：代理张三(id=100)提交了一个抖音推广视频
  ○ 不能为空：每个推广任务必须有明确的提交人
2. platform ENUM('douyin', 'xiaohongshu', 'kuaishou') NOT NULL (平台)
  ○ 场景：区分推广任务发生的平台，便于分类管理和效果分析
  ○ 实例：
    ■ “douyin”：抖音视频任务
    ■ “xiaohongshu”：小红书图文任务
3. type ENUM('text', 'video', 'real_person') DEFAULT 'text' (类型)
  ○ 场景：区分推广内容的类型，不同类型可能有不同奖励
  ○ 实例：
    ■ “video”：视频推广，奖励可能更高
    ■ “text”：图文推广
4. url TEXT DEFAULT NULL (推广链接)
  ○ 场景：代理提交推广内容的链接，供管理员审核
  ○ 实例：https://v.douyin.com/iJXXXXXX/
  ○ 允许NULL：有些任务可能不需要链接，或链接后补
5. status ENUM('pending', 'approved', 'rejected') DEFAULT 'pending' (状态)
  ○ 场景：推广任务的审核流程管理
  ○ 实例：
    ■ pending: 待审核
    ■ approved: 审核通过，发放奖励
    ■ rejected: 审核拒绝，不发放奖励
6. audit_by BIGINT DEFAULT NULL (审核人)
  ○ 场景：记录审核任务的管理员，用于责任追溯
  ○ 实例：任务由管理员李四(id=200)审核
7. audit_reason TEXT DEFAULT NULL (审核原因)
  ○ 场景：提供审核反馈，特别是拒绝原因，帮助代理改进
  ○ 实例：“视频内容与产品无关，请重新提交”
8. reward_amount DECIMAL(10,2) DEFAULT 0.00 (奖励金额)
  ○ 场景：记录完成任务后获得的固定奖励，独立于销售佣金
  ○ 实例：发布一条符合要求的视频，奖励50.00元
9. created_at DATETIME DEFAULT CURRENT_TIMESTAMP (创建时间)
  ○ 场景：记录任务提交的时间
10. audited_at DATETIME DEFAULT NULL (审核时间)
  ○ 场景：记录任务被审核的时间，用于分析审核效率
🔗 约束设计
1. FOREIGN KEY (agent_id) REFERENCES users(id) ON DELETE RESTRICT
  ○ 场景：保护任务记录的完整性，防止删除有推广记录的代理
  ○ 实例：如果代理张三有待审核的推广任务，不能直接删除其账户
2. FOREIGN KEY (audit_by) REFERENCES users(id) ON DELETE SET NULL
  ○ 场景：审核人离职或账户被删除后，保留任务的审核历史
  ○ 实例：管理员李四离职，其审核过的任务记录依然有效，只是audit_by字段变为NULL