# å·¥ä½œæµçš„åç§°ï¼Œä¼šæ˜¾ç¤ºåœ¨ GitHub Actions çš„ UI ç•Œé¢ä¸Š
name: Java CI with Maven

# è§¦å‘å·¥ä½œæµçš„äº‹ä»¶
on:
  push:
    branches: [ "main", "dev" ] # å½“ä»£ç è¢« pushåˆ° main æˆ– dev åˆ†æ”¯æ—¶è§¦å‘
  pull_request:
    branches: [ "main", "dev" ] # å½“æœ‰ pull request æäº¤åˆ° main æˆ– dev åˆ†æ”¯æ—¶è§¦å‘

# å·¥ä½œæµåŒ…å«çš„ä»»åŠ¡ï¼ˆjobsï¼‰
jobs:
  # ä»»åŠ¡çš„ IDï¼Œå¯ä»¥è‡ªå®šä¹‰ï¼Œè¿™é‡Œæˆ‘ä»¬å«å®ƒ "build"
  build:
    # æŒ‡å®šè¿è¡Œæ­¤ä»»åŠ¡çš„è™šæ‹Ÿæœºç¯å¢ƒï¼Œ"ubuntu-latest" æ˜¯ä¸€ä¸ªå¸¸ç”¨çš„ã€é¢„è£…äº†å¾ˆå¤šå·¥å…·çš„ Linux ç¯å¢ƒ
    runs-on: ubuntu-latest

    # ä»»åŠ¡çš„æ‰§è¡Œæ­¥éª¤ï¼ˆstepsï¼‰
    steps:
      # ç¬¬ä¸€æ­¥ï¼šæ£€å‡ºä½ çš„ä»£ç 
      # ä½¿ç”¨å®˜æ–¹çš„ actions/checkout@v3 åŠ¨ä½œ
      - name: Checkout repository
        uses: actions/checkout@v4

      # ç¬¬äºŒæ­¥ï¼šè®¾ç½® Java ç¯å¢ƒ
      # ä½¿ç”¨äº†å®˜æ–¹çš„ actions/setup-java@v4 åŠ¨ä½œ
      # æ ¹æ®ä½ çš„é¡¹ç›®éœ€æ±‚ï¼Œå¯ä»¥ä¿®æ”¹ 'java-version'
      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: 'maven' # å¯ç”¨ Maven ä¾èµ–ç¼“å­˜ï¼Œå¯ä»¥åŠ é€Ÿåç»­æ„å»º

      # ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨ Maven æ„å»ºé¡¹ç›®
      # è¿è¡Œ mvn clean package å‘½ä»¤æ¥ç¼–è¯‘å’Œæ‰“åŒ…é¡¹ç›® <sup data-citation='{&quot;id&quot;:1,&quot;url&quot;:&quot;/Users/suki/Desktop/åˆ†é”€ç³»ç»Ÿ/md æ–‡ä»¶/instructions.md&quot;,&quot;title&quot;:&quot;/Users/suki/Desktop/åˆ†é”€ç³»ç»Ÿ/md æ–‡ä»¶/instructions.md&quot;,&quot;content&quot;:&quot;Jenkins + GitHub Actions + ACK + ACR æ—¥å¿—ç›‘æ§ ELK Loki + Prometheus + Grafanaï¼ˆå¯é€‰ï¼‰ ğŸš€ å¯åŠ¨æ–¹å¼ 1 æ„å»ºæ‰€æœ‰æœåŠ¡ï¼š mvn clean package 2 å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼š docker-compose up --build -d 3 è®¿é—®æ¥å£æ–‡æ¡£ï¼š æ ¸å¿ƒä¸šåŠ¡æµç¨‹ é”€å”®æ³¨å†Œ â†’ ç”Ÿæˆé‚€è¯·ç é‚€è¯·ä»£ç† ä»£ç†æ³¨å†Œ â†’ æäº¤å®¢èµ„ï¼ˆæ‰‹&quot;}'>1</sup>
      - name: Build with Maven
        run: mvn clean package
